REM File Name: rootloci.bas
DIM G(50),H(50),C(50),M(10)
PRINT"ROOTLOCI WILL CALCULATE AND/OR PLOT THE LOCUS OF ROOTS OF A"
PRINT"LINEAR CONTROL SYSTEM WITH NEGATIVE FEEDBACK.  THE OPEN LOOP"
PRINT"TRANSFER FUNCTION 'GH' IS DEFINED BY A NUMERATOR POLYNOMIAL"
PRINT"AND A DENOMINATOR POLYNOMIAL.  EACH POLYNOMIAL IS ENTERED AS"
PRINT"A SERIES OF POLYNOMIAL FACTORS OF THE FORM:"
PRINT
PRINT"A(0)+A(1)*S^(1)+ ... +A(N-1)*S^(N-1)+A(N)*S^(N)"
PRINT
PRINT"THE MAXIMUM DEGREE (N) OF ANY POLYNOMIAL IS 50.  THIS LIMIT"
PRINT"APPLIES IN PRACTICE TO THE POLYNOMIAL WHICH RESULTS FROM THE"
PRINT"PRODUCT OF THE DENOMINATOR FACTORS."
PRINT
PRINT"THE USER MUST HAVE STORED OR ACCESS TO TWO ADDITIONAL PROGRAMS:"
PRINT"     LPLOTTER----- THE PLOTTING PROGRAM"
PRINT"     STORE-------- A STORAGE FILE"
PRINT
PRINT"FOR INFORMATION CALL: DICK GORDON,8*235-2914/ 8*235-4737"
PRINT"     LARGE STEAM TURBINE DEPARTMENT"
PRINT"     BLD. 285  RM 231"
PRINT"     SCHENECTADY, NEW YORK"
PRINT
LET K=0
FOR I=0 TO 9
M(I)=10.**(I/10.)
NEXT I
FILES STORE
SCRATCH #1
PRINT"NUMERATOR OF GH";
GOSUB 3270
LET N1=N0
FOR I=0 TO N1
LET G(I)=C(I)
NEXT I
PRINT"OPEN LOOP ZEROS"
GOSUB 1690
PRINT
PRINT"DENOMINATOR OF GH";
GOSUB 3270
LET N2=N0
FOR I=0 TO N2
LET H(I)=C(I)
NEXT I
PRINT"OPEN LOOP POLES"
GOSUB 1690
IF N1<=N2 THEN 1370
LET N0=N1
PRINT
PRINT
PRINT
SCRATCH #1
PRINT"ENTER: INITIAL AND FINAL GAIN VALUES (K>0)";
INPUT K0,K9
K9=K9
PRINT"DO YOU WANT A TABULATION OF THE ROOTS";
INPUT A$
FOR D=0 TO 9
LET K=K0*M(D)
GOSUB 1580
IF K>=K9 THEN 1520
NEXT D
LET K0=10*K0
GOTO 1450
PRINT
PRINT"     ***** END OF CALCULATIONS *****"
WRITE #1,1E33
CHAIN "LPLOTTER"
INPUT K0,K9
GOTO 1420
FOR I=0 TO N0
LET S=0
IF I>N1 THEN 1620
LET S=S+K*G(I)
IF I>N2 THEN 1640
LET S=S+H(I)
LET C(I)=S
NEXT I
IF A$="NO" THEN 1690
PRINT
PRINT"CLOSED LOOP POLES FOR K=";K;" (";20*LOG(K)/LOG(10);" DB)"
LET N=N0
DIM B(50),D(50)
LET N=N0
LET L1=-1
IF C(N)<>0 THEN 1760
LET N=N-1
IF N>0 THEN 1730
IF N>0 THEN 1790
PRINT"DEGREE IS ZERO, NO ROOTS"
GOTO 3260
IF C(0)<>0 THEN 1880
IF A$="NO" THEN 1820
PRINT 0
LET N=N-1
FOR I=0 TO N
LET C(I)=C(I+1)
NEXT I
IF N>0 THEN 1790
IF N<=0 THEN 3260
IF N>1 THEN 1910
LET R=-C(1)/C(0)
GOTO 2670
IF N>2 THEN 1950
LET P=C(1)/C(0)
LET Q=C(2)/C(0)
GOTO 2810
LET P1=0
LET P2=0
LET Q1=0
LET Q2=0
LET X=1E-7
LET S=SQR(ABS(C(0)*C(N)))
FOR I=0 TO N
LET C(I)=C(I)/S
NEXT I
IF ABS(C(1)/C(0))>=ABS(C(N-1)/C(N)) THEN 2120
LET L1=-L1
FOR I=0 TO (N-1)/2+.1
LET J=N-I
LET T=C(I)
LET C(I)=C(J)
LET C(J)=T
NEXT I
IF Q1=0 THEN 2160
LET P=P1
LET Q=Q1
GOTO 2240
LET P=C(N-2)
IF P<>0 THEN 2210
LET Q=1
LET P=-2
GOTO 2230
LET Q=C(N-1)/P
LET P=Q-C(N-3)*Q/P
LET R=0
FOR L2=1 TO 20
LET B(0)=C(0)
LET C1=B(0)
LET D(0)=C(0)
LET B(1)=C(1)-B(0)*P
LET C2=B(1)-C1*P
LET D(1)=C(1)+R*D(0)
LET E1=D(1)+R*D(0)
FOR I=2 TO N-1
LET B(I)=C(I)-B(I-1)*P-B(I-2)*Q
LET C0=C1
LET C1=C2
LET C2=B(I)-C1*P-C0*Q
LET D(I)=C(I)+R*D(I-1)
LET E0=E1
LET E1=D(I)+R*E0
NEXT I
LET T1=C(N)-P*B(N-1)-Q*B(N-2)
LET C2=-P*C1-Q*C0
LET T=C1*C1-C2*C0
LET P3=B(N-1)*C1-T1*C0
LET Q3=T1*C1-B(N-1)*C2
IF ABS(P3)>X*ABS(P*T) THEN 2480
IF ABS(Q3)<=X*ABS(Q*T) THEN 2810
IF T<>0 THEN 2520
LET P=P-2
LET Q=Q*(Q+1)
GOTO 2540
LET P=P+P3/T
LET Q=Q+Q3/T
LET T=C(N)+R*D(N-1)
IF ABS(T)<=X*ABS(R*E1) THEN 2670
IF E1<>0 THEN 2590
LET R=R-1
GOTO 2600
LET R=R-T/E1
NEXT L2
LET P1=P2
LET Q1=Q2
LET P2=P
LET Q2=Q
LET X=10*X
GOTO 2050
IF L1>0 THEN 2690
LET R=1/R
IF A$="NO" THEN 2710
PRINT R
H1=0
IF R>0 THEN 2740
H1=180
V1=ABS(R)
WRITE #1,V1,H1,20*LOG(K)/LOG(10)
LET N=N-1
FOR I=0 TO N
LET C(I)=D(I)
NEXT I
GOTO 1870
IF L1>0 THEN 2840
LET P=P/Q
LET Q=1/Q
LET T=P*P/4-Q
IF T>=0 THEN 3020
LET T1=-P/2
LET T=SQR(-T)
LET S=SQR(ABS(Q))
IF A$="NO" THEN2920
PRINT T1;"  + J";T;"   DAMPING FACTOR =";-T1/S
PRINT T1;"  - J";T;"    NATURAL FREQ. =";S
IF T1>0 THEN 2980
IF T1<0 THEN 2960
H1=90
GOTO 2990
H1=180-ATN(-T/T1)*180/3.14159265
GOTO 2990
H1=ATN(T/T1)*180/3.14159265
V1=S
WRITE #1,V1,H1,20*LOG(K)/LOG(10)
GOTO 3210
LET T=SQR(T)+ABS(P)/2
IF P<0 THEN 3050
LET T=-T
IF A$="NO" THEN3070
PRINT Q/T
IF (Q/T)<0 THEN 3100
IF (Q/T)>0 THEN 3120
GOTO 3130
WRITE #1,(-Q/T),180,20*LOG(K)/LOG(10)
GOTO 3130
WRITE #1,(Q/T),0,20*LOG(K)/LOG(10)
IF A$="NO" THEN 3150
PRINT T
IF T<0 THEN 3180
IF T>0 THEN 3200
GOTO 3210
WRITE #1,-T,180,20*LOG(K)/LOG(10)
GOTO 3210
WRITE #1,T,0,20*LOG(K)/LOG(10)
LET N=N-2
FOR I=0 TO N
LET C(I)=B(I)
NEXT I
GOTO 1870
RETURN
LET N0=0
LET C(0)=1
PRINT":  HOW MANY FACTORS ARE THERE";
INPUT M
FOR L=1 TO M
PRINT
PRINT"     FACTOR #";L;"IS OF WHAT DEGREE";
INPUT M1
LET M2=N0+M1
FOR I=0 TO M2
LET H(I)=C(I)
LET C(I)=0
NEXT I
FOR I=0 TO M1
PRINT"          A(";I;") =";
INPUT X
FOR J=0 TO N0
LET K=I+J
LET C(K)=C(K)+H(J)*X
NEXT J
NEXT I
LET N0=M2
NEXT L
PRINT"     DEGREE OF THE RESULTANT POLYNOMIAL IS:";N0
PRINT"     COEFFICIENTS OF RESULTANT POLYNOMIAL ARE (CONST. FIRST):";
FOR I=0 TO N0
PRINT C(I);
NEXT I
PRINT
PRINT
RETURN
END
